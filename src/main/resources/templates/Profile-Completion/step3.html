<!DOCTYPE html>
<html  lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Profile Completion</title>
    <link rel="stylesheet" th:href="@{/css/basic-template.css}" href="/static/css/basic-template.css">
    <link rel="stylesheet" th:href="@{/css/Profile-Completion/step3.css}" href="/static/css/Profile-Completion/step3.css">
    <link rel="stylesheet" th:href="@{/css/jquery/jquery-ui.theme.min.css}" href="/static/css/jquery/jquery-ui.theme.min.css">
    <link rel="stylesheet" th:href="@{/css/jquery/jquery-ui.structure.min.css}" href="/static/css/jquery/jquery-ui.structure.min.css">
    <link rel="stylesheet" th:href="@{/css/jquery/jquery-ui.min.css}" href="/static/css/jquery/jquery-ui.min.css">
    <script src="/static/js/jquery-3.3.1.min.js" th:src="@{/js/jquery-3.3.1.min.js}"></script>
    <script src="/static/js/jquery.iframe-transport.js" th:src="@{/js/jquery.iframe-transport.js}"></script>
    <!--<script src="/static/js/jquery.ui.widget.js" th:src="@{/js/jquery.ui.widget.js}"></script>-->
    <script src="/static/js/jquery-ui.min.js" th:src="@{/js/jquery-ui.min.js}"></script>



</head>
<body>

    <p id = "header">
        We need a few more details.
    </p>
    <main>
        <form th:action="@{/profileCompletion}" action="" name = "pincode" id = "pincode" method="POST">
            <div class="ui-widget" id="1pincode">
                <label for="search-pincode" id = "title">Your preffered pick-up locations:</label>

                <!--<input   type = "search" id = "search-pincode" name = "search-pincode" placeholder="Search Pincode" autocomplete="off"  value="" >-->
                <input class ="ui-autocomplete-input" type = "search" id = "search-pincode" name = "search-pincode" placeholder="Search Pincode" >
                <span id="search-pincode-results" class="ui-front">
                </span>
                <button type = "submit" form="pincode" id="next">Submit</button>
            </div>
            <input type="hidden" name="page" value="3">
        </form>
    </main>
    

<script>
    // document.getElementById('search-pincode').autofocus;

    function search() {
        var input, filter, div, i;
        input = document.getElementById('search-pincode');
        filter = input.value.toUpperCase();
        div = document.getElementsByClassName('pin-div');
        document.getElementById('search-results-list').style.display = "block";

        for (i = 0; i < div.length; i++) {
            if (filter != ""){
                if (div[i].innerHTML.toUpperCase().indexOf(filter) > -1) { 
                    div[i].style.display = "";
                } else {
                    div[i].style.display = "none";
                }
            }
            else document.getElementById('search-results-list').style.display = "none";
        }
    }

    function confirmpincode(id) {
        var x = 2408, y = 1;
        document.getElementById('selected-pin-content').innerHTML += "<div class = \"selected-pin-content-list-div\">" + document.getElementById(id).innerHTML + "<br>" + "<input type = \"checkbox\" id = \"x\" name = \"Specify Timings:\" onclick = \"specifytimings(x)\">" + "<label style = \"font-size:0.7em\" for = \"x\"> Specify Timings </label>" + "<select id = \"select-timings\" form = \"pincode\"> <option> 09:00-10:00</option><option> 10:00-11:00</option><option> 11:00-12:00</option> </select>" + "<select id = \"select-timings-am-pm\" form = \"pincode\"> <option>AM</option> <option>PM</option> </select>" + "</div>";
        x++;
        document.getElementById(id).style.display = "none";
        document.getElementById(id).innerHTML = "";
        document.getElementById('search-results-list').style.display = "none";
        document.getElementById('selected-pincodes').style.border = "1px solid #CCCCCC";
    }

    function specifytimings(x) {
        document.getElementById('x').checked = "true";
        document.getElementById('select-timings').style.display = "inline";
        document.getElementById('select-timings-am-pm').style.display = "inline";
    }

    $(document).ready(function() {

        $("#search-pincode").autocomplete({
            appendTo  : "#search-pincode-results",
            minLength: 2,
            delay: 500,
            //define callback to format results
            source: function (request, response) {
                $.getJSON("/getPinCodeLandMark", request, function(result) {
                    response($.map(result, function(item) {
                        return {
                            // following property gets displayed in drop down
                            label: item.landmark+"-"+item.pincode,
                            // following property gets entered in the textbox
                            value: item.landmark+"-"+item.pincode,
                            // following property is added for our own use
                            landmarks: item.landmark,
                            pincode:item.pincode
                        }

                    }));
                });
            },

            //define select handler
            select : function(event, ui) {
                if (ui.item) {
                    event.preventDefault();
                    $("#selected_tags span").append('<a href=' + ui.item.tag_url + ' class="btn-metadata2">'+ ui.item.label +'</a>');
                    //$("#tagQuery").value = $("#tagQuery").defaultValue
                    var defValue = $("#tagQuery").prop('defaultValue');
                    $("#tagQuery").val(defValue);
                    $("#tagQuery").blur();
                    document.getElementById("search-pincode-results").innerHTML += "<br>" + ui.item.label;
                    $("#search-pincode").autocomplete("close");
                        return false;
                }
            }

        });
    });
</script>

</body>
</html>